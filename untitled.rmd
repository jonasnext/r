#
# r | art
#

```{r}
library(tidyverse)
```

# circle

```{r}
seq(0, 1, .01) %>%
data.frame(a=.) %>%
ggplot(aes(x=a, y=0)) +
geom_point(alpha=.2, color="#000000", size=0) +
coord_polar() +
theme_void()
```

# flower | rose

```{r}
seq(-pi, pi, .01) %>%
data.frame(a=.) %>%
ggplot(aes(x=a, y=2*sin(4*a))) +
geom_point(alpha=.2, color="#000000", size=0) +
coord_polar() +
theme_void()
```

# flower | rose #2

```{r}
seq(-2*pi, 2*pi, .01) %>%
data.frame(a=.) %>%
ggplot(aes(x=a, y=cos(3*a))) +
geom_point(alpha=.2, color="#000000", size=0) +
coord_polar() +
theme_void()
```

# golden flower

```{r}
golden_ratio <- (1+sqrt(5))/2
golden_angle <- pi*(3-sqrt(5))

gold_titanium = c("#eba584", "#d4a67c", "#c3ad95", "#554e41")

(seq(0, 100, 1) * golden_angle) %>%
data.frame(a=., x=sin(.), y=cos(.)) %>%
ggplot(aes(x=a*x, y=a*y)) +
geom_point(aes(color=a, size=0), alpha=.1, show.legend=F) +
scale_color_gradientn(colors=gold_titanium) +
theme_void() +
theme(plot.background=element_rect("#f4f4f4")) +
theme(plot.margin=unit(c(4, 4, 4, 4), "cm"))
```

# lisa

```{r}
gold_titanium = c("#eba584", "#d4a67c", "#c3ad95", "#554e41")

a <- 1
b <- 1
c <- 1
A <- 10
B <- 10

(seq(-2*pi, 2*pi, .1)) %>%
data.frame(t=.) %>%
ggplot(aes(x=A*sin(a*t+c), y=B*sin(b*t))) +
geom_point(aes(color=t, size=0), alpha=.1, show.legend=F) +
scale_color_gradientn(colors=gold_titanium) +
theme_void() +
theme(plot.background=element_rect("#f4f4f4")) +
theme(plot.margin=unit(c(4, 4, 4, 4), "cm"))
```

# rose

```{r}
gold_titanium = c("#eba584", "#d4a67c", "#c3ad95", "#554e41")
slate = c("#383836")

n <- 8
d <- 4

angle <- 10*(pi/180)

makeRose <- function(n, d, angle) {
    r <- (seq(0, 8*pi, .04)) %>%
    data.frame(t=.) %>%
    mutate(x=cos(n/d*t)*cos(t), y=cos(n/d*t)*sin(t)) %>%
    mutate(xx=x*cos(angle)-y*sin(angle), yy=x*sin(angle)+y*cos(angle)) %>%
    ggplot(aes(x=xx, y=yy)) +
    geom_point(aes(color=t, size=0), alpha=.1, show.legend=F) +
    scale_color_gradientn(colors=slate) +
    theme_void() +
    theme(plot.background=element_rect("#f4f4f4")) +
    theme(plot.margin=unit(c(4, 4, 4, 4), "cm"))
    return(r)
}

rose <- makeRose(8, 4, 0)
rose
```

# rose animation

```{r}

easeInOutCubic <- function(x) {
    return(ifelse(x < 0.5, 4*x*x*x, 1 - ((-2*x+2)^3) / 2))
}

sequence <- seq(0, 1, 1/60) %>% easeInOutCubic() %>% `*`(2*pi)

imap(sequence, function(angle, i) {
    rose <- makeRose(8, 4, angle)
    fn <- paste(str_pad(i-1, 2, "left", "0"), "png", sep=".")
    ggsave(fn, rose, units="in", width=1800/300, height=1800/300)
})

```

# xy <3

```{r}

# shape (201, 1) -> (40401, 2)

seq(-1, 1, .01) %>%
expand.grid(x=., y=.) %>%
ggplot(aes(x=pi*x-cos(y^2), y=1-sin(x^2))) +
geom_point(alpha=.02, color="#000000", size=0) +
coord_polar() +
theme_void()
```

# xyz

```{r}
seq(-pi, pi, .1) %>%
expand.grid(x=., y=., z=.) %>%
ggplot(aes(x=x+y+z, y=x*y*z)) +
geom_point(alpha=.1, color="#000000", size=0) +
coord_polar() +
theme_void()
```

# xyz #2

```{r}
get_log <- function(filename) {
    if (file.exists(filename)) {
        return(read.csv(filename, sep="\t"))
    }
    return(data.frame(date=NA, seed=NA, x=NA, y=NA))
}
```

```{r}
model <- list(
    x=quote(runif(1,-1,1)*x+runif(1,-1,1)*y^2+runif(1,-1,1)*z^3),
    y=quote(runif(1,-1,1)*x+runif(1,-1,1)*y+runif(1,-1,1)*z)
    )

log <- "log.csv"
sequence <- seq(0, 1, 1)
seeds <- sample(1:1000, length(sequence))
log_df = get_log(log)

seeds_log <- log_df %>%
    dplyr::filter(x == as.character(model["x"])) %>%
    dplyr::filter(y == as.character(model["y"])) %>%
    dplyr::filter(seed %in% seeds) %>%
    dplyr::pull(seed) %>%
    unique(.)

seeds <- seeds[(!(seeds %in% seeds_log))]

result <- map(seeds, function(seed) {
    set.seed(seed)

    a <- seq(-pi, pi, .1) %>%
    expand.grid(x=., y=., z=.) %>%
    mutate(!!!model) %>%
    ggplot(aes(x=x, y=y)) +
    geom_point(alpha=.08, color="#000000", size=0) +
    coord_polar() +
    theme_void()

    t <- format(Sys.time(), format="%F_%H-%M-%S")
    fn <- paste(paste(t, seed, sep="_"), "png", sep=".")

    ggsave(fn, a, units="in", width=1800/300, height=1800/300)

    log_df <- get_log(log)
    new_df <- data.frame(date=t, seed=seed, x=as.character(model["x"]), y=as.character(model["y"]))
    log_df <- bind_rows(log_df, new_df)
    write.table(log_df, log, sep="\t", row.names=F)
})
```

# save

```{r}
t <- format(Sys.time(), format="%F_%H-%M-%S")
fn <- paste(t, "png", sep=".")
ggsave(fn, units="in", width=1800/300, height=1800/300)
```
